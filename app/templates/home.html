{% extends "base.html" %}

{% block content %}
<h2 class="mb-4">üõçÔ∏è –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π –∑–∞–∫–∞–∑</h2>

<form method="POST" action="{{ url_for('web.add_order') }}" class="p-4 border rounded mb-4">
    <div class="row g-3">
        <div class="col-md-4">
            <input type="text" name="client_name" placeholder="–ò–º—è –∫–ª–∏–µ–Ω—Ç–∞ *" required class="form-control">
        </div>
        <div class="col-md-4">
            <input type="email" name="email" placeholder="Email *" required class="form-control">
        </div>
        <div class="col-md-3">
            <select name="product_id" class="form-select" required>
                <option value="">–í—ã–±–µ—Ä–∏—Ç–µ —Ç–æ–≤–∞—Ä</option>
                {% for p in products %}
                    <option value="{{ p.id }}">{{ p.name }} ‚Äî {{ p.price }} ‚ÇΩ</option>
                {% endfor %}
            </select>
        </div>
        <div class="col-md-1">
            <input type="number" name="quantity" value="1" min="1" max="10" class="form-control">
        </div>
        <div class="col-12">
            <button type="submit" class="btn btn-success w-100">‚úÖ –î–æ–±–∞–≤–∏—Ç—å –∑–∞–∫–∞–∑</button>
        </div>
    </div>
</form>

<h3 class="mb-3">üìã –ü–æ—Å–ª–µ–¥–Ω–∏–µ –∑–∞–∫–∞–∑—ã</h3>
{% if orders %}
    <table class="table table-striped table-hover">
        <thead>
            <tr>
                <th>–ö–ª–∏–µ–Ω—Ç</th>
                <th>–¢–æ–≤–∞—Ä</th>
                <th>–ö–æ–ª-–≤–æ</th>
                <th>–°—É–º–º–∞</th>
                <th>–î–∞—Ç–∞</th>
            </tr>
        </thead>
        <tbody>
            {% for o in orders %}
            <tr>
                <td>{{ o.client.name }}</td>
                <td>{{ o.product.name }}</td>
                <td>{{ o.quantity }}</td>
                <td><strong>{{ o.total_price }} ‚ÇΩ</strong></td>
                <td>{{ o.created_at.strftime('%d.%m.%Y %H:%M') }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
{% else %}
    <div class="alert alert-info">–ü–æ–∫–∞ –Ω–µ—Ç –∑–∞–∫–∞–∑–æ–≤. üõí –î–æ–±–∞–≤—å—Ç–µ –ø–µ—Ä–≤—ã–π!</div>
{% endif %}

<a href="{{ url_for('web.export') }}" class="btn btn-primary mt-3">üì• –≠–∫—Å–ø–æ—Ä—Ç –≤ CSV</a>
{% endblock %}