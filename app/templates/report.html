<!-- app/templates/report.html -->
{% extends "base.html" %}

{% block content %}
<h2 class="mb-4">üìä –û—Ç—á—ë—Ç –ø–æ –ø—Ä–æ–¥–∞–∂–∞–º</h2>

<!-- –ì—Ä–∞—Ñ–∏–∫–∏ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ -->
<h3 class="mb-4 text-muted">üìà –ì—Ä–∞—Ñ–∏–∫–∏ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –ø—Ä–æ–¥–∞–∂</h3>

<!-- –ì—Ä–∞—Ñ–∏–∫: –î–∏–Ω–∞–º–∏–∫–∞ –≤—ã—Ä—É—á–∫–∏ –ø–æ –¥–Ω—è–º -->
<div class="mb-4">
    {{ sales_chart|safe }}
</div>

<!-- –ì—Ä–∞—Ñ–∏–∫: –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ (–∫—Ä—É–≥–æ–≤–∞—è) -->
<div class="mb-4">
    {{ pie_chart|safe }}
</div>

<!-- –ì—Ä–∞—Ñ–∏–∫: –¢–æ–ø-5 –∫–ª–∏–µ–Ω—Ç–æ–≤ -->
<div class="mb-4">
    {{ top_clients_chart|safe }}
</div>

<!-- –ì—Ä–∞—Ñ–∏–∫: –¢–æ–ø-5 —Ç–æ–≤–∞—Ä–æ–≤ -->
<div class="mb-4">
    {{ top_products_chart|safe }}
</div>

<!-- ‚úÖ –ù–û–í–´–ô –ì–†–ê–§–ò–ö: –í—ã—Ä—É—á–∫–∞ –ø–æ —Å—Ç—Ä–∞–Ω–∞–º -->
<div class="mb-4">
    {{ country_revenue_chart|safe }}
</div>

<!-- –¢–∞–±–ª–∏—Ü–∞ –æ–±—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö -->
<h4 class="mt-5">üìà –û–±—â–∏–µ –¥–∞–Ω–Ω—ã–µ</h4>
<table class="table table-bordered">
    <tr><th>–ü–æ–∫–∞–∑–∞—Ç–µ–ª—å</th><th>–ó–Ω–∞—á–µ–Ω–∏–µ</th></tr>
    <tr><td>–í—Å–µ–≥–æ –∑–∞–∫–∞–∑–æ–≤</td><td><strong>{{ total_orders }}</strong></td></tr>
    <tr><td>–û–±—â–∞—è –≤—ã—Ä—É—á–∫–∞</td><td><strong>{{ total_revenue }} ‚ÇΩ</strong></td></tr>
    <tr><td>–°—Ä–µ–¥–Ω–∏–π —á–µ–∫</td><td><strong>{{ avg_ticket }} ‚ÇΩ</strong></td></tr>
    <tr><td>–£–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤</td><td><strong>{{ unique_clients }}</strong></td></tr>
</table>

<h4 class="mt-5">üìã –í—Å–µ –∑–∞–∫–∞–∑—ã</h4>
{% if orders %}
    <table class="table table-striped">
        <thead>
            <tr>
                <th>ID</th>
                <th>–ö–ª–∏–µ–Ω—Ç</th>
                <th>–¢–æ–≤–∞—Ä</th>
                <th>–ö–æ–ª-–≤–æ</th>
                <th>–°—É–º–º–∞</th>
                <th>–î–∞—Ç–∞</th>
            </tr>
        </thead>
        <tbody>
            {% for o in orders %}
            <tr>
                <td>{{ o.order.id }}</td>
                <td>{{ o.firstname }} {{ o.lastname }}</td>
                <td>{{ o.product_name }}</td>
                <td>{{ o.order.quantity }}</td>
                <td><strong>{{ o.order.total_price }} ‚ÇΩ</strong></td>
                <td>{{ o.order.created_at.strftime('%d.%m.%Y') }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
{% else %}
    <div class="alert alert-info">–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –æ—Ç—á—ë—Ç–∞.</div>
{% endif %}
{% endblock %}